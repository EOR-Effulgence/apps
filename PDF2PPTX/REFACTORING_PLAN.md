# PDF2PNG/PDF2PPTX ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ»Windows ãƒ“ãƒ«ãƒ‰æº–å‚™è¨ˆç”»

## ğŸ¯ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç›®æ¨™

### 1. **Windowsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å“è³ªå‘ä¸Š**
- ãƒ¢ãƒ€ãƒ³ãªWindowsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¨™æº–ã¸ã®æº–æ‹ 
- PyInstalleræœ€é©åŒ–ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã®å¼·åŒ–
- é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æœ€é©åŒ–

### 2. **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ”¹å–„**
- ã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆæ€§å‘ä¸Š
- ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®æ”¹å–„
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚æœ€é©åŒ–
- è¨­å®šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®çµ±ä¸€

## ğŸ“‹ Phase 1: ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹åˆ†æã¨æº–å‚™

### âœ… **ç¾çŠ¶ã®è‰¯ã„ç‚¹**
- ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ¸ˆã¿ï¼‰
- åŒ…æ‹¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 
- å‹ãƒ’ãƒ³ãƒˆå®Œå‚™
- è¨­å®šã‚·ã‚¹ãƒ†ãƒ ã®å……å®Ÿ

### ğŸ”§ **æ”¹å–„ãŒå¿…è¦ãªé ˜åŸŸ**

#### A. **UI/UX ãƒ¬ã‚¤ãƒ¤ãƒ¼**
- å›ºå®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚º â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- åŸºæœ¬çš„ãªtkinter â†’ ãƒ¢ãƒ€ãƒ³ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- åŒæœŸå‡¦ç† â†’ éåŒæœŸå‡¦ç†ã§ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–æ€§å‘ä¸Š

#### B. **è¨­å®šç®¡ç†**
- åˆ†æ•£ã—ãŸè¨­å®šé …ç›®ã®çµ±ä¸€
- Windowså›ºæœ‰è¨­å®šã®è¿½åŠ 
- ãƒ¬ã‚¸ã‚¹ãƒˆãƒªé€£æºã®æ¤œè¨

#### C. **ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–**
- ä¾å­˜é–¢ä¿‚ã®æœ€å°åŒ–
- ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—æ™‚é–“ã®çŸ­ç¸®
- å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã®æœ€é©åŒ–

## ğŸ—ï¸ Phase 2: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

### 2.1 **MVPãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…**

```python
# æ–°ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹é€ 
src/
â”œâ”€â”€ core/                    # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ—¢å­˜ãƒ»è‰¯å¥½ï¼‰
â”‚   â”œâ”€â”€ pdf_processor.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ presentation/            # æ–°è¦ï¼šãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”œâ”€â”€ presenters/
â”‚   â”‚   â”œâ”€â”€ main_presenter.py
â”‚   â”‚   â”œâ”€â”€ conversion_presenter.py
â”‚   â”‚   â””â”€â”€ settings_presenter.py
â”‚   â””â”€â”€ view_models/
â”‚       â”œâ”€â”€ main_view_model.py
â”‚       â””â”€â”€ conversion_view_model.py
â”œâ”€â”€ ui/                      # ãƒ“ãƒ¥ãƒ¼å±¤ï¼ˆæ”¹è‰¯ï¼‰
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ main_window.py
â”‚   â”‚   â”œâ”€â”€ settings_dialog.py
â”‚   â”‚   â””â”€â”€ progress_dialog.py
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ file_selector.py
â”‚   â”‚   â”œâ”€â”€ preview_panel.py
â”‚   â”‚   â””â”€â”€ progress_bar.py
â”‚   â””â”€â”€ styles/
â”‚       â”œâ”€â”€ theme_manager.py
â”‚       â””â”€â”€ windows_theme.py
â”œâ”€â”€ infrastructure/          # ã‚¤ãƒ³ãƒ•ãƒ©å±¤
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ app_config.py
â”‚   â”‚   â”œâ”€â”€ user_preferences.py
â”‚   â”‚   â””â”€â”€ windows_registry.py
â”‚   â”œâ”€â”€ logging/
â”‚   â”‚   â”œâ”€â”€ logger_factory.py
â”‚   â”‚   â””â”€â”€ windows_event_log.py
â”‚   â””â”€â”€ file_system/
â”‚       â”œâ”€â”€ path_resolver.py
â”‚       â””â”€â”€ temp_file_manager.py
â””â”€â”€ application/             # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
    â”œâ”€â”€ services/
    â”‚   â”œâ”€â”€ conversion_service.py
    â”‚   â”œâ”€â”€ validation_service.py
    â”‚   â””â”€â”€ notification_service.py
    â””â”€â”€ use_cases/
        â”œâ”€â”€ convert_pdf_to_png.py
        â”œâ”€â”€ convert_pdf_to_pptx.py
        â””â”€â”€ manage_user_settings.py
```

### 2.2 **ä¾å­˜æ€§æ³¨å…¥ã‚³ãƒ³ãƒ†ãƒŠ**

```python
# src/infrastructure/container.py
from dependency_injector import containers, providers
from dependency_injector.wiring import Provide, inject

class ApplicationContainer(containers.DeclarativeContainer):
    # Configuration
    config = providers.Configuration()

    # Infrastructure
    logger = providers.Singleton(LoggerFactory)
    file_manager = providers.Singleton(FileManager)
    config_manager = providers.Singleton(ConfigManager)

    # Core Services
    pdf_processor = providers.Factory(
        PDFProcessor,
        logger=logger,
        file_manager=file_manager
    )

    # Application Services
    conversion_service = providers.Factory(
        ConversionService,
        pdf_processor=pdf_processor,
        logger=logger
    )

    # Presenters
    main_presenter = providers.Factory(
        MainPresenter,
        conversion_service=conversion_service,
        config_manager=config_manager
    )
```

### 2.3 **éåŒæœŸå‡¦ç†ã®å®Ÿè£…**

```python
# src/presentation/presenters/conversion_presenter.py
import asyncio
from typing import Callable, Optional
from concurrent.futures import ThreadPoolExecutor

class ConversionPresenter:
    def __init__(self, conversion_service, progress_callback: Callable):
        self.conversion_service = conversion_service
        self.progress_callback = progress_callback
        self.executor = ThreadPoolExecutor(max_workers=2)

    async def convert_files_async(self, files: List[Path], config: ConversionConfig):
        """éåŒæœŸãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›"""
        loop = asyncio.get_event_loop()

        # é‡ã„å‡¦ç†ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œ
        future = loop.run_in_executor(
            self.executor,
            self._convert_files_sync,
            files,
            config
        )

        # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ç›£è¦–ã‚’ä¸¦è¡Œå®Ÿè¡Œ
        progress_task = asyncio.create_task(
            self._monitor_progress(future)
        )

        try:
            result = await future
            progress_task.cancel()
            return result
        except Exception as e:
            progress_task.cancel()
            raise e

    async def _monitor_progress(self, future):
        """ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ç›£è¦–"""
        while not future.done():
            await asyncio.sleep(0.1)
            # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°
            self.progress_callback(self.conversion_service.get_progress())
```

## ğŸ¨ Phase 3: UI/UX ãƒ¢ãƒ€ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

### 3.1 **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–UIè¨­è¨ˆ**

```python
# src/ui/views/main_window.py
import tkinter as tk
from tkinter import ttk
from typing import Protocol

class MainViewInterface(Protocol):
    def show_progress(self, percentage: int, message: str): ...
    def show_error(self, error: str): ...
    def update_file_list(self, files: List[FileInfo]): ...

class ModernMainWindow(tk.Tk):
    def __init__(self, presenter):
        super().__init__()
        self.presenter = presenter
        self._setup_window()
        self._create_responsive_layout()
        self._apply_modern_styling()

    def _setup_window(self):
        """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦åŸºæœ¬è¨­å®š"""
        self.title("PDF2PNG/PDF2PPTX Converter v3.0")
        self.minsize(800, 600)
        self.geometry("1000x700")

        # Windowsãƒã‚¤ãƒ†ã‚£ãƒ–å¤–è¦³
        self.configure(bg='#f0f0f0')

        # ã‚¢ã‚¤ã‚³ãƒ³è¨­å®š
        try:
            self.iconbitmap('assets/app_icon.ico')
        except:
            pass  # ã‚¢ã‚¤ã‚³ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã¯ç„¡è¦–

    def _create_responsive_layout(self):
        """ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä½œæˆ"""
        # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ
        main_container = ttk.Frame(self)
        main_container.pack(fill='both', expand=True, padx=10, pady=10)

        # 3ãƒšã‚¤ãƒ³æ§‹æˆ
        # å·¦ï¼šãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        # ä¸­å¤®ï¼šè¨­å®šãƒ‘ãƒãƒ«
        # å³ï¼šãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒ»ãƒ­ã‚°

        self._create_file_panel(main_container)
        self._create_settings_panel(main_container)
        self._create_progress_panel(main_container)
```

### 3.2 **Windowsãƒã‚¤ãƒ†ã‚£ãƒ–ä½“é¨“**

```python
# src/ui/styles/windows_theme.py
import tkinter as tk
from tkinter import ttk
import sys

class WindowsThemeManager:
    def __init__(self):
        self.is_dark_mode = self._detect_windows_dark_mode()
        self.setup_theme()

    def _detect_windows_dark_mode(self) -> bool:
        """Windows ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ¤œå‡º"""
        if sys.platform == "win32":
            try:
                import winreg
                registry = winreg.ConnectRegistry(None, winreg.HKEY_CURRENT_USER)
                key = winreg.OpenKey(
                    registry,
                    r"SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize"
                )
                value, _ = winreg.QueryValueEx(key, "AppsUseLightTheme")
                return value == 0  # 0 = dark mode
            except:
                return False
        return False

    def setup_theme(self):
        """ãƒ†ãƒ¼ãƒé©ç”¨"""
        style = ttk.Style()

        if self.is_dark_mode:
            self._apply_dark_theme(style)
        else:
            self._apply_light_theme(style)

    def _apply_dark_theme(self, style):
        style.theme_use('clam')
        style.configure('TLabel', background='#2d2d2d', foreground='#ffffff')
        style.configure('TFrame', background='#2d2d2d')
        style.configure('TButton', background='#404040', foreground='#ffffff')
        # ...ä»–ã®ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
```

## ğŸ”§ Phase 4: Windows ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–

### 4.1 **PyInstallerè¨­å®šæ”¹è‰¯**

```python
# build_windows_optimized.spec
# -*- mode: python ; coding: utf-8 -*-

import os
import sys
from pathlib import Path

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆå–å¾—
project_root = Path(__file__).parent
src_path = project_root / "src"

# éš ã‚ŒãŸã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
hiddenimports = [
    'tkinter',
    'tkinter.ttk',
    'tkinter.filedialog',
    'tkinter.messagebox',
    'PIL._tkinter_finder',
    'fitz',
    'pptx',
    'pptx.util',
    'pptx.dml.color',
    'pptx.enum.shapes',
    'dependency_injector',
    'asyncio',
    'concurrent.futures',
    'queue',
    'threading',
    'multiprocessing',
]

# ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
datas = [
    (str(src_path / "ui" / "assets"), "assets"),
    (str(project_root / "config"), "config"),
    ("README.md", "."),
]

block_cipher = None

a = Analysis(
    ['main.py'],
    pathex=[str(project_root), str(src_path)],
    binaries=[],
    datas=datas,
    hiddenimports=hiddenimports,
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[
        'matplotlib',  # ä¸è¦ãªå¤§ããªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é™¤å¤–
        'numpy',
        'scipy',
        'pandas',
        'jupyter',
        'IPython',
        'pytest',
        'mypy',
        'black',
    ],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

# é‡è¤‡ã—ãŸãƒã‚¤ãƒŠãƒªã‚’é™¤å»
a.binaries = a.binaries - TOC([
    ('mfc140u.dll', None, None),
    ('mfcm140u.dll', None, None),
])

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='PDF2PNG_Converter',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,  # UPXåœ§ç¸®æœ‰åŠ¹
    upx_exclude=[],
    runtime_tmpdir=None,
    console=False,  # ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦éè¡¨ç¤º
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon='assets/app_icon.ico',  # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ã‚³ãƒ³
    version='version_info.txt',  # ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
)
```

### 4.2 **ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«**

```python
# version_info.txt
VSVersionInfo(
  ffi=FixedFileInfo(
    filevers=(3,0,0,0),
    prodvers=(3,0,0,0),
    mask=0x3f,
    flags=0x0,
    OS=0x40004,
    fileType=0x1,
    subtype=0x0,
    date=(0, 0)
  ),
  kids=[
    StringFileInfo(
      [
      StringTable(
        u'041103a4',
        [StringStruct(u'CompanyName', u'PDF2PNG Project'),
        StringStruct(u'FileDescription', u'PDF to PNG/PPTX Converter'),
        StringStruct(u'FileVersion', u'3.0.0.0'),
        StringStruct(u'InternalName', u'PDF2PNG_Converter'),
        StringStruct(u'LegalCopyright', u'Â© 2025 PDF2PNG Project'),
        StringStruct(u'OriginalFilename', u'PDF2PNG_Converter.exe'),
        StringStruct(u'ProductName', u'PDF2PNG/PDF2PPTX Converter'),
        StringStruct(u'ProductVersion', u'3.0.0.0')])
      ]),
    VarFileInfo([VarStruct(u'Translation', [1041, 932])])
  ]
)
```

### 4.3 **ãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

```powershell
# scripts/build_windows_release.ps1
param(
    [string]$Version = "3.0.0",
    [switch]$Clean = $false,
    [switch]$Test = $false
)

Write-Host "ğŸš€ PDF2PNG Windows Build Script v$Version" -ForegroundColor Cyan
Write-Host "===========================================" -ForegroundColor Cyan

# ç’°å¢ƒãƒã‚§ãƒƒã‚¯
Write-Host "ğŸ“‹ ç’°å¢ƒãƒã‚§ãƒƒã‚¯ä¸­..." -ForegroundColor Yellow

# Python ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
$pythonVersion = python --version 2>&1
if ($LASTEXITCODE -ne 0) {
    Write-Error "Python ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    exit 1
}
Write-Host "âœ… $pythonVersion" -ForegroundColor Green

# ä»®æƒ³ç’°å¢ƒã®ç¢ºèª
if (-not (Test-Path "venv")) {
    Write-Host "ğŸ“¦ ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆä¸­..." -ForegroundColor Yellow
    python -m venv venv
}

# ä»®æƒ³ç’°å¢ƒã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
Write-Host "ğŸ”§ ä»®æƒ³ç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆä¸­..." -ForegroundColor Yellow
& "venv\Scripts\Activate.ps1"

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Write-Host "ğŸ“¥ ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..." -ForegroundColor Yellow
pip install -r requirements.txt
pip install pyinstaller

if ($Clean) {
    Write-Host "ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œä¸­..." -ForegroundColor Yellow
    Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "build", "dist"
}

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
if ($Test) {
    Write-Host "ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­..." -ForegroundColor Yellow
    python -m pytest tests/ -v
    if ($LASTEXITCODE -ne 0) {
        Write-Error "ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ"
        exit 1
    }
}

# ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
Write-Host "ğŸ”¨ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ä¸­..." -ForegroundColor Yellow
pyinstaller build_windows_optimized.spec --clean

if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ… ãƒ“ãƒ«ãƒ‰æˆåŠŸï¼" -ForegroundColor Green

    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºç¢ºèª
    $exePath = "dist\PDF2PNG_Converter.exe"
    if (Test-Path $exePath) {
        $fileSize = (Get-Item $exePath).Length / 1MB
        Write-Host "ğŸ“Š å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: $([math]::Round($fileSize, 1)) MB" -ForegroundColor Cyan
    }

    # é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ
    Write-Host "ğŸ“¦ é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆä¸­..." -ForegroundColor Yellow
    $releaseDir = "release\PDF2PNG_Windows_v$Version"
    New-Item -ItemType Directory -Force -Path $releaseDir

    Copy-Item "dist\PDF2PNG_Converter.exe" "$releaseDir\"
    Copy-Item "README.md" "$releaseDir\"
    Copy-Item "PDF2PNG_ä»•æ§˜æ›¸.md" "$releaseDir\"

    # ZIPä½œæˆ
    Compress-Archive -Path $releaseDir -DestinationPath "release\PDF2PNG_Windows_v$Version.zip" -Force

    Write-Host "ğŸ‰ é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å®Œæˆ: release\PDF2PNG_Windows_v$Version.zip" -ForegroundColor Green
} else {
    Write-Error "ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ"
    exit 1
}
```

## ğŸ§ª Phase 5: ãƒ†ã‚¹ãƒˆãƒ»å“è³ªä¿è¨¼

### 5.1 **è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ‹¡å¼µ**

```python
# tests/test_windows_integration.py
import pytest
import tempfile
import subprocess
from pathlib import Path

class TestWindowsIntegration:
    """Windowså›ºæœ‰ã®çµ±åˆãƒ†ã‚¹ãƒˆ"""

    def test_executable_startup(self):
        """å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®èµ·å‹•ãƒ†ã‚¹ãƒˆ"""
        exe_path = Path("dist/PDF2PNG_Converter.exe")
        if not exe_path.exists():
            pytest.skip("å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")

        # èµ·å‹•ãƒ†ã‚¹ãƒˆï¼ˆçŸ­æ™‚é–“ã§çµ‚äº†ï¼‰
        process = subprocess.Popen(
            [str(exe_path), "--test-mode"],
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE
        )

        # 3ç§’å¾Œã«çµ‚äº†
        try:
            stdout, stderr = process.communicate(timeout=3)
            assert process.returncode == 0
        except subprocess.TimeoutExpired:
            process.terminate()
            # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¯æ­£å¸¸ï¼ˆGUIã‚¢ãƒ—ãƒªã®ãŸã‚ï¼‰

    def test_file_associations(self):
        """ãƒ•ã‚¡ã‚¤ãƒ«é–¢é€£ä»˜ã‘ãƒ†ã‚¹ãƒˆ"""
        # Windows ãƒ¬ã‚¸ã‚¹ãƒˆãƒªç¢ºèª
        pass

    def test_memory_usage(self):
        """ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ†ã‚¹ãƒˆ"""
        import psutil
        import os

        # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–
        process = psutil.Process(os.getpid())
        initial_memory = process.memory_info().rss / 1024 / 1024  # MB

        # å¤§ããªPDFãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ†ã‚¹ãƒˆ
        # ...ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ...

        final_memory = process.memory_info().rss / 1024 / 1024
        memory_increase = final_memory - initial_memory

        # ãƒ¡ãƒ¢ãƒªå¢—åŠ ãŒ200MBä»¥ä¸‹ã§ã‚ã‚‹ã“ã¨
        assert memory_increase < 200, f"ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒéå¤§ã§ã™: {memory_increase}MB"
```

### 5.2 **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**

```python
# tests/test_performance.py
import time
import pytest
from pathlib import Path
from src.core.pdf_processor import PDFProcessor

class TestPerformance:
    """ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""

    @pytest.mark.performance
    def test_conversion_speed(self):
        """å¤‰æ›é€Ÿåº¦ãƒ†ã‚¹ãƒˆ"""
        test_files = [
            "sample_pdfs/small_1page.pdf",
            "sample_pdfs/medium_10pages.pdf",
            "sample_pdfs/large_50pages.pdf"
        ]

        processor = PDFProcessor()

        for test_file in test_files:
            if not Path(test_file).exists():
                continue

            start_time = time.time()
            # å¤‰æ›å®Ÿè¡Œ
            end_time = time.time()

            processing_time = end_time - start_time

            # ãƒšãƒ¼ã‚¸ã‚ãŸã‚Š1ç§’ä»¥ä¸‹ã§ã‚ã‚‹ã“ã¨
            pages = processor.count_pages(Path(test_file))
            time_per_page = processing_time / pages

            assert time_per_page < 1.0, f"å¤‰æ›é€Ÿåº¦ãŒé…ã™ãã¾ã™: {time_per_page}ç§’/ãƒšãƒ¼ã‚¸"
```

## ğŸ“¦ Phase 6: é…å¸ƒãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼

### 6.1 **Windowsã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ä½œæˆ**

```nsis
; PDF2PNG_Installer.nsi - NSIS ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
!define APP_NAME "PDF2PNG Converter"
!define APP_VERSION "3.0.0"
!define APP_PUBLISHER "PDF2PNG Project"
!define APP_URL "https://github.com/pdf2png/pdf2png-converter"
!define APP_EXEC "PDF2PNG_Converter.exe"

; ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼è¨­å®š
Name "${APP_NAME}"
OutFile "PDF2PNG_Converter_v${APP_VERSION}_Setup.exe"
InstallDir "$PROGRAMFILES\${APP_NAME}"
RequestExecutionLevel admin

; ãƒšãƒ¼ã‚¸è¨­å®š
!insertmacro MUI_PAGE_WELCOME
!insertmacro MUI_PAGE_LICENSE "LICENSE.txt"
!insertmacro MUI_PAGE_DIRECTORY
!insertmacro MUI_PAGE_INSTFILES
!insertmacro MUI_PAGE_FINISH

; ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒšãƒ¼ã‚¸
!insertmacro MUI_UNPAGE_WELCOME
!insertmacro MUI_UNPAGE_CONFIRM
!insertmacro MUI_UNPAGE_INSTFILES
!insertmacro MUI_UNPAGE_FINISH

; è¨€èªè¨­å®š
!insertmacro MUI_LANGUAGE "Japanese"
!insertmacro MUI_LANGUAGE "English"

; ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†
Section "MainSection" SEC01
  SetOutPath "$INSTDIR"

  ; ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼
  File "dist\PDF2PNG_Converter.exe"
  File "README.md"
  File "PDF2PNG_ä»•æ§˜æ›¸.md"

  ; ãƒ¬ã‚¸ã‚¹ãƒˆãƒªè¨­å®š
  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APP_NAME}" \
                   "DisplayName" "${APP_NAME}"
  WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APP_NAME}" \
                   "UninstallString" "$INSTDIR\Uninstall.exe"

  ; ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
  CreateDirectory "$SMPROGRAMS\${APP_NAME}"
  CreateShortCut "$SMPROGRAMS\${APP_NAME}\${APP_NAME}.lnk" "$INSTDIR\${APP_EXEC}"
  CreateShortCut "$DESKTOP\${APP_NAME}.lnk" "$INSTDIR\${APP_EXEC}"

  ; ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ä½œæˆ
  WriteUninstaller "$INSTDIR\Uninstall.exe"
SectionEnd

; ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡¦ç†
Section "Uninstall"
  Delete "$INSTDIR\PDF2PNG_Converter.exe"
  Delete "$INSTDIR\README.md"
  Delete "$INSTDIR\PDF2PNG_ä»•æ§˜æ›¸.md"
  Delete "$INSTDIR\Uninstall.exe"

  ; ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå‰Šé™¤
  Delete "$SMPROGRAMS\${APP_NAME}\${APP_NAME}.lnk"
  Delete "$DESKTOP\${APP_NAME}.lnk"
  RMDir "$SMPROGRAMS\${APP_NAME}"

  ; ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  DeleteRegKey HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APP_NAME}"

  RMDir "$INSTDIR"
SectionEnd
```

## ğŸš€ å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### **Week 1-2: åŸºç›¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**
- [x] PowerPointè¨­å®šã‚·ã‚¹ãƒ†ãƒ å®Œæˆ
- [ ] MVPã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®Ÿè£…
- [ ] ä¾å­˜æ€§æ³¨å…¥ã‚·ã‚¹ãƒ†ãƒ å°å…¥
- [ ] éåŒæœŸå‡¦ç†åŸºç›¤æ§‹ç¯‰

### **Week 3-4: UI/UXæ”¹å–„**
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–UIå®Ÿè£…
- [ ] Windowsãƒ†ãƒ¼ãƒå¯¾å¿œ
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œUIå¼·åŒ–
- [ ] ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºæ”¹å–„

### **Week 5-6: ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–**
- [ ] PyInstallerè¨­å®šæœ€é©åŒ–
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿæ–½
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æœ€é©åŒ–
- [ ] èµ·å‹•æ™‚é–“çŸ­ç¸®

### **Week 7-8: é…å¸ƒæº–å‚™**
- [ ] Windowsã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ä½œæˆ
- [ ] è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ‹¡å……
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆå®Ÿæ–½

## ğŸ¯ æˆåŠŸæŒ‡æ¨™

### **æŠ€è¡“çš„æŒ‡æ¨™**
- èµ·å‹•æ™‚é–“: < 3ç§’
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: < 100MB (ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚)
- å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: < 50MB
- å¤‰æ›é€Ÿåº¦: < 1ç§’/ãƒšãƒ¼ã‚¸

### **å“è³ªæŒ‡æ¨™**
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸: > 85%
- é™çš„è§£æã‚¨ãƒ©ãƒ¼: 0ä»¶
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§: 0ä»¶
- ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢: > 4.5/5.0

ã“ã®è¨ˆç”»ã«ã‚ˆã‚Šã€PDF2PNGã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¾ä»£çš„ã§é«˜å“è³ªãªWindowsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€²åŒ–ã•ã›ã€å„ªç§€ãªé…å¸ƒå¯èƒ½ãªå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã§ãã¾ã™ã€‚